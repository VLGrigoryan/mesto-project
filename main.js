(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){e.classList.add("popup_opened"),document.addEventListener("keydown",o),e.addEventListener("mousedown",r)}function n(e){e&&(e.classList.remove("popup_opened"),document.removeEventListener("keydown",o),e.removeEventListener("mousedown",r))}function o(e){"Escape"===e.key&&n(document.querySelector(".popup_opened"))}function r(e){var t=document.querySelector(".popup_opened");t&&e.target.classList.contains("popup_opened")&&n(t)}e.d({},{$2:()=>j,wg:()=>B,ep:()=>g,FG:()=>D,ul:()=>P,c4:()=>S,OP:()=>E,sQ:()=>O,N0:()=>x,vV:()=>b,O9:()=>A,KC:()=>L,vi:()=>C,Wu:()=>f,f:()=>d,Iz:()=>z,zn:()=>y,rC:()=>m,Ph:()=>_,d$:()=>w,jH:()=>N,cY:()=>T,xS:()=>$,E3:()=>I});var i=function(e,t,n,o){o.textContent=n?e:t};function c(e){!function(e){g.prepend(e)}(function(e){var n=E.querySelector(".element").cloneNode(!0),o=n.querySelector(".element__image"),r=n.querySelector(".element__heading"),i=n.querySelector(".element__like-button"),c=n.querySelector(".element__like-quantity");if(o.src=e.link,o.alt=e.name,r.textContent=e.name,c.textContent=e.likes.length||0,e.owner._id===$){var a=n.querySelector(".element__delete-button");a.addEventListener("click",(function(){return function(e,t){return fetch("https://nomoreparties.co/v1/plus-cohort-22/cards/".concat(e._id),{method:"DELETE",headers:{authorization:"d00ddee1-e29e-4e26-92aa-43ddefc5b31a"}}).then((function(e){if(e.ok)return e.json()})).then((function(){t.closest(".element").remove(),console.log(e)})).catch((function(e){console.error(e)}))}(e,n)})),a.style.display=a?"block":"none"}return i.addEventListener("click",(function(t){var n=t.target.closest(".element").querySelector(".element__like-quantity");i.classList.contains("element__like-button_checked")?function(e,t){fetch("https://nomoreparties.co/v1/plus-cohort-22/cards/likes/".concat(e._id),{method:"DELETE",headers:{authorization:"d00ddee1-e29e-4e26-92aa-43ddefc5b31a","Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json()})).then((function(e){t.textContent=e.likes.length})).catch((function(e){console.error(e)}))}(e,n):function(e,t){fetch("https://nomoreparties.co/v1/plus-cohort-22/cards/likes/".concat(e._id),{method:"PUT",headers:{authorization:"d00ddee1-e29e-4e26-92aa-43ddefc5b31a","Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json()})).then((function(e){t.textContent=e.likes.length})).catch((function(e){console.error(e)}))}(e,n),i.classList.toggle("element__like-button_checked")})),e.likes.some((function(e){return e._id===$}))&&i.classList.add("element__like-button_checked"),o.addEventListener("click",(function(){t(b),C.src=e.link,C.alt=e.name,L.textContent=e.name})),n}(e))}var a=function(e,t){var n=e.every((function(e){return e.validity.valid}));t.disabled=!n,t.classList.toggle(I.inactiveButtonClass,!n)},u=function(e,t){var n=e.querySelector(t.submitButtonSelector),o=Array.from(e.querySelectorAll(t.inputSelector)),r=function(e){var n=e.nextElementSibling;e.classList.add(t.inputErrorType),n.classList.add(t.inputErrorClass)};o.forEach((function(e){e.addEventListener("input",(function(){!function(e){var i=e.nextElementSibling;""===e.value?(r(e),i.textContent=e.getAttribute("data-error-empty-string")):"url"===e.type&&e.validity.typeMismatch?(r(e),i.textContent=e.getAttribute("data-error-link")):1===e.value.trim().length?(r(e),i.textContent=e.getAttribute("data-error-semi-empty-string")):e.validity.patternMismatch?(r(e),i.textContent=e.getAttribute("data-error-pattern")):function(e){var n=e.nextElementSibling;e.classList.remove(t.inputErrorType),n.classList.remove(t.inputErrorClass)}(e),a(o,n)}(e)}))})),a(o,n)},l=function(){a(Array.from(O.querySelectorAll(I.inputSelector)),O.querySelector(I.submitButtonSelector))},s=document.querySelector(".profile__container"),d=s.querySelector(".profile__avatar-image"),p=s.querySelector(".profile__avatar-edit-button"),m=s.querySelector(".profile__info-name"),f=s.querySelector(".profile__info-activity"),h=s.querySelector(".profile__info-edit-button"),v=document.querySelector(".profile__addcard-button"),y=document.querySelector("#confirm-avatar-popup"),_=document.querySelector("#profile-popup"),S=document.querySelector("#card-popup"),b=document.querySelector("#image-popup"),q=(document.querySelector("#confirm-delete-popup"),document.querySelectorAll(".popup__close-button")),g=document.querySelector(".elements"),E=document.querySelector("#element-template").content,k=document.querySelector(".popup__image-container"),C=k.querySelector(".popup__image"),L=k.querySelector(".popup__image-caption"),x=document.querySelector("#profile-edit"),A=x.querySelector("#user-name"),j=x.querySelector("#user-activity"),T=document.getElementById("submitButtonProfile"),z=document.querySelector("#ConfirmAvatar"),B=document.querySelector("#avatar-url"),w=document.getElementById("submitButtonAvatar"),O=document.querySelector("#profile-addcard"),P=O.querySelector("#card-name"),D=O.querySelector("#card-url"),N=document.getElementById("submitButtonCard"),$="99972b32a73a45c3db68b1e2",I={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__save-button",inputErrorSelector:".form__input-error",inactiveButtonClass:"form__save-button_inactive",inputErrorType:"form__input_type-erorr",inputErrorClass:"form__input-error_active",validationMessages:{emptyString:"Вы пропустили это поле.",semiEmptyString:"Минимальное количество символов: 2. Длина текста сейчас: 1 символ.",naem:"Разрешены только латинские, кириллические буквы, знаки дефиса и пробелы",activity:"Разрешены только латинские, кириллические буквы, знаки дефиса и пробелы",place:"Разрешены только латинские, кириллические буквы, знаки дефиса и пробелы",link:"Введите адрес сайта."},validationRules:{name:{required:!0,minlength:2,maxlength:40,pattern:/^[a-zA-Zа-яА-ЯёЁ_ -]+$/},activity:{required:!0,minlength:2,maxlength:200,pattern:/^[a-zA-Zа-яА-ЯёЁ_ -]+$/},place:{required:!0,minlength:2,maxlength:30,pattern:/^[a-zA-Zа-яА-ЯёЁ_ -]+$/},link:{required:!0,url:!0}}};!function(e){u(x,e),u(O,e),u(z,e)}(I),p.addEventListener("mousedown",(function(){t(y),l()})),v.addEventListener("mousedown",(function(){t(S),l()})),h.addEventListener("mousedown",(function(){A.value=m.textContent,j.value=f.textContent,t(_),a(Array.from(x.querySelectorAll(I.inputSelector)),x.querySelector(I.submitButtonSelector))})),q.forEach((function(e){var t=e.closest(".popup");e.addEventListener("mousedown",(function(e){n(t)}))})),O.addEventListener("submit",(function(e){e.preventDefault();var t=P.value,o=D.value;i("Сохранение...","Сохранить",!0,N),function(e,t){return fetch("https://nomoreparties.co/v1/plus-cohort-22/cards",{method:"POST",headers:{authorization:"d00ddee1-e29e-4e26-92aa-43ddefc5b31a","Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){if(e.ok)return e.json()})).then((function(e){c(e)})).catch((function(e){console.error(e)}))}(t,o).then((function(){P.value="",D.value="",n(S)})).finally((function(){i("Сохранение...","Сохранить",!1,N)}))})),x.addEventListener("submit",(function(e){e.preventDefault(),m.textContent=A.value,f.textContent=j.value,d.alt=A.value,i("Сохранение...","Сохранить",!0,T),fetch("https://nomoreparties.co/v1/plus-cohort-22/users/me",{method:"PATCH",headers:{authorization:"d00ddee1-e29e-4e26-92aa-43ddefc5b31a","Content-Type":"application/json"},body:JSON.stringify({name:A.value,about:j.value})}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.error(e)})).then((function(e){m.textContent=e.name,f.textContent=e.about,n(_)})).finally((function(){i("Сохранение...","Сохранить",!1,T)}))})),z.addEventListener("submit",(function(e){e.preventDefault();var t=B.value;d.src=t,i("Сохранение...","Сохранить",!0,w),function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-22/users/me/avatar",{method:"PATCH",headers:{authorization:"d00ddee1-e29e-4e26-92aa-43ddefc5b31a","Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.error(e)}))}(t).finally((function(){i("Сохранение...","Сохранить",!1,w),n(y)}))})),fetch("https://nomoreparties.co/v1/plus-cohort-22/users/me",{headers:{authorization:"d00ddee1-e29e-4e26-92aa-43ddefc5b31a"}}).then((function(e){if(e.ok)return e.json()})).then((function(e){console.log(e),m.textContent=e.name,f.textContent=e.about,d.src=e.avatar,d.alt=e.name})).catch((function(e){console.error(e)})),fetch("https://nomoreparties.co/v1/plus-cohort-22/cards",{headers:{authorization:"d00ddee1-e29e-4e26-92aa-43ddefc5b31a"}}).then((function(e){if(e.ok)return e.json()})).then((function(e){e.reverse().forEach((function(e){c(e)}))})).catch((function(e){console.error(e)}))})();